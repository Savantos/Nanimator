<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7" prefix="og: http://ogp.me/ns#" > <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8" prefix="og: http://ogp.me/ns#"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9" prefix="og: http://ogp.me/ns#"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" prefix="og: http://ogp.me/ns#"> <!--<![endif]-->
<head>
	<meta charset="utf-8">
	<title>CSS3 Storyline Animation using jQuery Transit Library</title>
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Lato:400">
	<link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Source+Sans+Pro:400,900">
	<link href='http://fonts.googleapis.com/css?family=Bangers' rel='stylesheet' type='text/css'>
	<script src='js/jquery-1.10.2.js'></script>
	
	<script src='js/jquery.transit.js'></script>
	<style type="text/css">
	body{
		/*height: 10000px;*/
		font-family: "Lato";
		background-color: #2980b9;
	}
	ul.slider{
		list-style-type: none;
		position: relative;
		padding: 0px;
		margin: 0px;
		width: 800px;
		height: 350px;
		background-color: #fff;
		margin-left: 100px;
		margin-bottom: 200px;
		overflow: hidden;
		font-family: 'Bangers', cursive;
	}

	ul.slider li.slide{
		position: absolute;
		list-style-type: none;
		padding: 0px;
		margin: 0px;
		width: 800px;
		overflow: hidden;
		height: 350px;
	}

	ul.slider li.slider div.element{
		position: absolute;
	}



	.slide h1, .slide h2, .slide h3{
		color:#333;
		font-family: 'Bangers', cursive;
	}

	/** content **/
	.content{
		margin-top: 150px;
		margin-left: 100px;
		width: 700px;
		display: none;
	}
	h1, h2{
		font-family: "Source Sans Pro",sans-serif;
		color: #333;
		padding: 0px;
		margin: 0px;
		font-weight: normal;
	}

	h1{
		font-weight: 900;
		font-size: 64px;
	}

	h2{
		font-size:26px;
	}

	p{
		color: #ecf0f1;
		font-family: "Lato";
		line-height: 28px;
		font-size: 15px;
		padding-top: 50px;
	}

	p.credit{
		padding-top: 20px;
		font-size: 12px;
	}

	p a{
		color: #ecf0f1;
	}

	.hcolor{
		color:#c0392b;
	}

	/** fork icon**/
	.fork{
		position: absolute;
		top:0px;
		left: 0px;
	}

	/** Elements Def**/
	#se1-1{
		position: absolute;
		top:100px;
		left:200px;
		width: 410px;
		/*opacity: 0;*/
	}

	#se1-2{
		top:180px;
		position: absolute;
		left:20px;
		width: 380px;
		/*opacity:0;*/
		font-size: 36px;
	}

	#se1-3{
		top:180px;
		position: absolute;
		left:370px;
		width: 500px;
		font-size:36px;
	}

	#se1-4{
		transform:scale(0.5);
		opacity: 0;
		position: absolute;
		top:-100px;
		left:100px;
	}

	/*#se1-5{
		position: absolute;
		right:0px;
		opacity: 0;
		top:100;
		-webkit-transform-style: preserve-3d;
		-webkit-backface-visibility: hidden;
	}

	#se1-6, #se1-7,  #se1-8, #se1-9, #se1-10{
		position: absolute;
		top:200px;
		left: 40px;
		opacity: 0;
		-webkit-transform-style: preserve-3d;
		-webkit-backface-visibility: hidden;
	}

	#se1-7{
		left:150px;
	}

	#se1-8{
		left: 300px;
	}
	#se1-9{
		left: 430px;
	}
	#se1-10{
		left: 530px;
	}

	#se1-11{
		position: absolute;
		transform:scale(0.25);
		top:500;
		left:700;
		opacity: 0;
		-webkit-transform-style: preserve-3d;
		-webkit-backface-visibility: hidden;
	}

	#se1-12{
		position: absolute;
		right: 50px;
		top:-120px;
		opacity: 0;
		width: 150px;
		-webkit-transform-style: preserve-3d;
		-webkit-backface-visibility: hidden;
		}*/

		#fire{
			position: absolute;
			top:100px;
			left:100px;
		}

		</style>
		<script src='js/prefixfree.js'></script>
	</head>
	<body>
		<div class="fork">
			<a href='https://github.com/hasinhayder/CSS3-Storyline-Animation' target='_blank'><img src="img/fork.png" alt=""></a>
		</div>
		<div class="content">
			<h1>STORYLINE ANIMATION</h1>
			<h2>WITH CSS3 TRANSITIONS & JQUERY TRANSIT</h2>
			<p>
				This is an example of Storyline Animation with CSS3 Transitions and Animations using <a target='_blank' href='http://ricostacruz.com/jquery.transit/'>jQuery Transit Library</a>. I kept the code clean and uncluttered so that you can understand what's happening just by having a look at it. Meanwhile, I will suggest you to have a look at <a target='_blank' href='http://ricostacruz.com/jquery.transit/'>jQuery Transit Documentation</a>.
			</p>

			<p class="credit">
				Illustration Credit: <a href='http://miacabrera.deviantart.com/art/ken-masters-134143583' target='_blank'> Mia Cabrera</a>, <a href='http://y-u-k-i-k-o.deviantart.com/art/K-123283299' target='_blank'> y-u-k-i-k-o</a> and <a href='http://captain-tot.deviantart.com/art/KOF-King-209813954' target='_blank'> ~Captain-Tot</a>. The martial art movement silhouettes are purchased from <a target='_blank' href='http://www.shutterstock.com/pic-133247894/stock-photo-kungfu-fighter-super-human-special-power-mutant-stick-figure-pictogram-icon.html?src=same_artist-133247891-1'>ShutterStock</a>. 
			</p>
		</div>
		<div class="container">
			<ul class="slider">
				<li class="slide" id="slide1" style="display: none;">
					<img class='se nanimate' data-mt="2000" data-md="none" id='se1-4' src="img/comic/1.jpg" alt="">
					<!-- <img class='se' id='se1-5' src="img/comic/2.png" alt=""> -->
					<h1 data-release='true' data-duration="400" data-ma="40" data-fade='true' data-md="bottom" class='se nanimate' id="se1-1">THIS SUMMER</h1>
					<h1 data-ma="100" data-md="left" class='se nanimate' id="se1-2">THIS <span class="hcolor">HOTTER</span> NIGHT</h1>
					<h1 data-ma="100" data-md="right" class='se nanimate' id="se1-3">& THIS <span class="hcolor">HOTTEST</span> FIGHT</h1>	
				</li>
				<li class="slide" id="slide2">
					<img data-ease="snap" data-fade='true' class="nanimate" id="fire" data-time="1000" data-direction="right" data-distance="100" src="img/comic/7.png" alt="">
				</li>
			</ul>
		</div>

		<script type='text/javascript'>
		$(document).ready(function(){
	// $(".se").css({position:"absolute",opacity:1,display:"none"});
	$(".se").css({position:"absolute",opacity:0});
	// $(".test").show();
	// var anims = [];
	// var i=0;

	// $(".test").each(function(){
	// 	var ma = $(this).data("ma");
	// 	var md = $(this).data("md");
	// 	var mt = $(this).data("mt");
	// 	var parent = $(this).parents(".slide");
	// 	anims.push({
	// 		obj:$(this),
	// 		ma:ma,
	// 		md:md,
	// 		mt:mt,
	// 		p:parent
	// 	});

	// });
	// animationChain(0);

	// function animationChain(i){

	// 	if(!anims[i]){
	// 		//$(anims[i-1].p).find(".test").transition({opacity:0,delay:500});//reset
	// 		console.log("End");
	// 		return;
	// 	}

	// 	var animationDictionary = {
	// 		top:{
	// 			axis:"y",
	// 			factor:-1
	// 		},
	// 		bottom:{
	// 			axis:"y",
	// 			factor:1
	// 		},
	// 		left:{
	// 			axis:"x",
	// 			factor:-1
	// 		},
	// 		right:{
	// 			axis:"x",
	// 			factor:1
	// 		},
	// 		none:{
	// 			axis:0,
	// 			factor:0
	// 		}
	// 	}


	// 	var delay = 0;
	// 	if(i==0) delay=1000;

	// 	var element = anims[i];
	// 	var moveAmount = element.ma * animationDictionary[element.md].factor;
	// 	var moveAxis =  animationDictionary[element.md].axis;
	// 	var moveDuration = element.mt;
	// 	if(!moveDuration) moveDuration=300;
	// 	if(moveAxis!="none"){
	// 		var anim = {};
	// 		anim[moveAxis] = moveAmount*-1;
	// 		console.log(anim);
	// 		i+=1;
	// 		$(element.obj).transition(anim,0);
	// 	}

	// 	$(element.obj).transition({opacity:1,delay:delay,x:0,y:0},moveDuration,function(){
	// 		animationChain(i);
	// 	});
	// }

});

(function($){
	var ids = 0;
	var anims=[];
	var counters=[];
	var opts = {};
	var defaults = {
		cancel:false,
		reanimate:false, //set this param to true in cas eyou add a dynamic element in the container and want to regenerate the mapping
		delay:true
	}
	var animationDictionary = {
		top:{
			axis:"y",
			factor:-1
		},
		bottom:{
			axis:"y",
			factor:1
		},
		left:{
			axis:"x",
			factor:-1
		},
		right:{
			axis:"x",
			factor:1
		},
		none:{
			axis:0,
			factor:0
		}
	}
	$.fn.nanimate = function(options){	
		opts = $.extend(defaults,options);
		/** Preparation **/
		if($(this).attr("id")==""){
			//assign a temporary id
			ids+=1;
			id = "nanimated"+ids;
			$(this).attr("id",id);
		}
		else{
			id = $(this).attr("id");
		}
		
		//initiate the container variables
		anims[id]=[];
		counters[id]=0;


		/** Preparing the animation-able contents  - but check if they are already in the stack**/
		if(anims[id].length==0 || opts.reanimate){
			//fire the custom event that traversing through elements is now started
			$(this).trigger("nanimate.calculating");
			$(this).find(".nanimate").each(function(){
				var ma = $(this).data("distance");
				var md = $(this).data("direction");
				var mt = $(this).data("time");
				var fade = $(this).data("fade");
				var duration = $(this).data("duration");
				var release = $(this).data("release");
				var ease = $(this).data("ease");
				anims[id].push({
					obj:$(this),
					ma:ma,
					md:md,
					mt:mt,
					fade:fade,
					duration:duration,
					release:release,
					ease:ease
				});
				$(this).css({opacity:0});

			});
			$(this).trigger("nanimate.calculated");
		}
		// console.log(anims,counters);

		$(this).trigger("nanimate.started");
		$.fn.animationChain(id,counters[id]);

	}

	$.fn.animationChain = function(id, i){
		if(opts.cancel) return;
		if(!anims[id][i]){
			$("#"+id).trigger("nanimate.finished");
			//$(anims[i-1].p).find(".test").transition({opacity:0,delay:500});//reset
			// console.log("End");
			return;
		}

		var delay = 0;
		if(i==0 && opts.delay) delay=1000;

		var element = anims[id][counters[id]];
		var moveAmount = element.ma * animationDictionary[element.md].factor;
		var moveAxis =  animationDictionary[element.md].axis;
		var transitionTime = element.mt;
		var fade = element.fade;
		var duration = element.duration;
		var release = element.release;
		var ease = element.ease;
		if(!ease) ease="linear"
		if(!duration) duration=0;
		if(!transitionTime) transitionTime=300;
		if(moveAxis!="none"){
			var anim = {};
			anim[moveAxis] = moveAmount*-1;
			// console.log(anim);
			counters[id]+=1;
			$(element.obj).transition(anim,0);
		}

		$(element.obj).transition({opacity:1,delay:delay,x:0,y:0},transitionTime,ease,function(){
			if(fade==true){
				if(release!=true){
					$(element.obj).transition({opacity:0,delay:duration},function(){
						$.fn.animationChain(id,counters[id]);
					});
				}else{
					$(element.obj).transition({opacity:0,delay:duration});
					$.fn.animationChain(id,counters[id]);
				}
			}else{
				$.fn.animationChain(id,counters[id]);
			}
		});
	}

	
})(jQuery);

$(document).ready(function(){
	$("#slide2").nanimate({delay:false});
})
</script>

</body>
</html>
